<openerp>
    <data>
        <record id="res_partner_custom_form_view" model="ir.ui.view">
                <field name="name">Partner form view</field>
                <field name="model">res.partner</field>
                <field name="inherit_id" ref="base.view_partner_form"/>
                <field name="arch" type="xml">

                    <!-- Hide 'is a company'-div -->
                    <div class='oe_edit_only' position='attributes'>
                        <attribute name='invisible'>1</attribute>
                    </div>
                
                    <!-- Hide type field -->
                    <label for="type" position='replace' />
                    <field name="type" position='replace' />
                    <div name="div_type" position='replace' />

                    <field name='email' position='after'>
                        <field name='type' invisible='1' />
                    </field>

                    <!-- Hide parent address field -->
                    <field name='use_parent_address' position='replace'>
                        <field name='use_parent_address' attrs="{'invisible': [('parent_id', '=', False)]}" />
                    </field>

                    <label for="use_parent_address" position='attributes'>
                        <attribute name='attrs'>{'invisible': [('parent_id', '=', False)]}</attribute>
                    </label>

                    <button name="open_parent" position='attributes'>
                        <attribute name='invisible'>1</attribute>
                    </button>

                    <!-- Add a street address -->
                    <field name="website" position="before">
                        <field name="street_address" placeholder="Street address" />
                    </field>

                    <!--  Contacts -->
                    <xpath expr="//page[@string='Contacts']" position="attributes">
                        <attribute name='invisible'>1</attribute>
                    </xpath>

                    <xpath expr="//page[@string='Contacts']" position="after">

                        <page string="Affiliates" attrs="{'invisible': [('is_company','=',False)]}">

                            <field name="address_affiliate_ids"
                                context="{
                                    'tree_view_ref': 'crm_address_simplification.view_partner_simple_affiliate_tree',
                                    'default_parent_id': id,
                                    'default_type': 'delivery',
                                    'default_is_company': True,
                                    'default_use_parent_address': True,
                                    'default_supplier': supplier,
                                    'default_customer': customer,
                                }" />
                        </page>
                    </xpath>

                </field>

        </record>

        <record id="res_partner_form_view" model="ir.ui.view">
                <field name="name">Partner form view</field>
                <field name="model">res.partner</field>
                <field name="inherit_id" ref="res_partner_edicode.res_partner_form_view"/>
                <field name="arch" type="xml">
                    <field name="edicode" position="replace"/>
                    <field name="einvoice_operator" position="replace"/>
                    <field name="einvoice_operator_identifier" position="replace"/>

                    <!-- eInvoice addresses -->
                    <page name="sales_purchases" position="inside">
                        <group string="e-Invoice" attrs="{'invisible': [('is_company','=',False)]}">
                            <group>
                                <field name="edicode"/>
                                <field name="einvoice_operator"/>
                                <field name="einvoice_operator_identifier"/>
                            </group>
                            <group />
                        </group>
                    </page>
                </field>
        </record>

    </data>
</openerp>