<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
      	<record id="view_report_crm_claim_filter_extended" model="ir.ui.view">
            <field name="name">CRM Claim filter</field>
            <field name="model">crm.claim.report</field>
            <field name="inherit_id" ref="crm_claim.view_report_crm_claim_filter"/>
            <field name="arch" type="xml">

				<search position='inside'>
				                  
                    <group string='Stages'>
                        <filter string="New"    			name="stage_new" domain="[('stage_id','=',1)]"/>
                        <filter string="In Progress"    	name="stage_progress" domain="[('stage_id','=',2)]"/>
                        <filter string="Assigned"			name="stage_assigned" domain="[('stage_id','=',5)]"/>
                        <filter string="Waiting Customer"	name="stage_waiting_customer" domain="[('stage_id','=',6)]"/>
                        <filter string="Waiting"			name="stage_waiting" domain="[('stage_id','=',7)]"/>
                        <filter string="Settled"			name="stage_settled" domain="[('stage_id','=',3)]"/>
                        <filter string="Rejected"			name="stage_rejected" domain="[('stage_id','=',4)]"/>
                    </group>
				
					<group string='Measures'>
						<filter string='Claims' name="measure_claim" context="{'measures': ['nbr_claims']}" />
						<filter string='Emails' name="measure_email" context="{'measures': ['email']}" />
					</group>
				
		            <group string='Date grouping'>
			                <filter string="Week" name="claim_date_column_group_week" help="Group weekly by claim date" 
			                	context="{'col_group_by': ['claim_date:week']}"/>
		                <filter string="Month" name="claim_date_column_group_month" help="Group monthly by claim date" 
		                	context="{'col_group_by': ['claim_date:month']}"/>
		                <filter string="Year" name="claim_date_column_group_year" help="Group yearly by claim date" 
		                	context="{'col_group_by': ['claim_date:year']}"/>
		            </group>
		            
					<group string='Year' icon="terp-calendar">
                        <filter string="This year" name="year_this" domain="['&amp;',('claim_date','&lt;=', time.strftime('%%Y-12-31')),('claim_date','&gt;=',time.strftime('%%Y-01-01'))]"/>
                        <filter string="Last year" name="year_last"
                                domain="[('claim_date','&gt;=',(context_today()-relativedelta(years=1)).strftime('%%Y-01-01')),('claim_date','&lt;', time.strftime('%%Y-01-01'))]"/>

					   <separator orientation="vertical"/>

                        <filter string="2014" name="year_2014" domain="[('claim_date', 'like', '2014-')]"/>
					    <filter string="2015" name="year_2015" domain="[('claim_date', 'like', '2015-')]"/>
					    <filter string="2016" name="year_2016" domain="[('claim_date', 'like', '2016-')]"/>
					    <filter string="2017" name="year_2017" domain="[('claim_date', 'like', '2017-')]"/>
					</group>
					
                    <group string='Month'>
                        <filter string="This month" name="month_this"
                                domain="[('claim_date','&lt;',(context_today()+relativedelta(months=1)).strftime('%%Y-%%m-01')), ('claim_date','&gt;=',time.strftime('%%Y-%%m-01'))]"/>
                        <filter string="Last month" name="month_last"
                                domain="[('claim_date','&gt;=',(context_today()-relativedelta(months=1)).strftime('%%Y-%%m-01')),('claim_date','&lt;',time.strftime('%%Y-%%m-01'))]"/>

					   <separator orientation="vertical"/>

                        <filter string="January"    name="month_01" domain="[('claim_date','like','-01-')]"/>
                        <filter string="February"   name="month_02" domain="[('claim_date','like','-02-')]"/>
                        <filter string="March"      name="month_03" domain="[('claim_date','like','-03-')]"/>
                        <filter string="April"      name="month_04" domain="[('claim_date','like','-04-')]"/>
                        <filter string="May"        name="month_05" domain="[('claim_date','like','-05-')]"/>
                        <filter string="June"       name="month_06" domain="[('claim_date','like','-06-')]"/>
                        <filter string="July"       name="month_07" domain="[('claim_date','like','-07-')]"/>
                        <filter string="August"     name="month_08" domain="[('claim_date','like','-08-')]"/>
                        <filter string="September"  name="month_09" domain="[('claim_date','like','-09-')]"/>
                        <filter string="October"    name="month_10" domain="[('claim_date','like','-10-')]"/>
                        <filter string="November"   name="month_11" domain="[('claim_date','like','-11-')]"/>
                        <filter string="December"   name="month_12" domain="[('claim_date','like','-12-')]"/>
                    </group>

		        </search>
		        
		        <!-- Remove obsolete filters -->
		        <filter string='Sales Team' position='replace' />
		        <filter string='Claim Month' position='replace' />
            	
            	<!-- Modify existing filters -->
            	<filter name="Salesperson" position='replace'>
            		<filter string="Responsible" name="responsible" context="{'group_by':'user_id'}" />
            	</filter>
            	
            	<filter string='My Company' position='attributes'>
            		<attribute name='name'>my_company</attribute>
            	</filter>
            	
            	<filter string='Stage' position='attributes'>
            		<attribute name='name'>stage</attribute>
            	</filter>
            	
            </field>
      	</record>
    </data>
</openerp>